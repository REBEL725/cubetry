jQuery.fn.cropper=function(){this.each(function(){var e=new Image,t=jQuery(this).attr("id");e.src=jQuery(this).attr("src");var r=document.createElement("div");jQuery(r).addClass("crop_wrapper").css({width:e.width,height:e.height});var n=document.createElement("input");jQuery(n).attr({id:t+"_x",name:t+"[x]",type:"hidden"}),jQuery(r).append(n);var i=document.createElement("input");jQuery(i).attr({id:t+"_y",name:t+"[y]",type:"hidden"}),jQuery(r).append(i);var a=document.createElement("input");jQuery(a).attr({id:t+"_h",name:t+"[h]",type:"hidden"}),jQuery(r).append(a);var o=document.createElement("input");jQuery(o).attr({id:t+"_w",name:t+"[w]",type:"hidden"}),jQuery(r).append(o);var p=document.createElement("div");jQuery(p).addClass("crop_source").css({width:e.width,height:e.height,background:"transparent url("+e.src+") no-repeat scroll 0%",opacity:.3});t=document.createElement("div");jQuery(t).addClass("crop_select").resizable({containment:"parent",handles:"all",knobHandles:!0,ghost:!1,autoHide:!1,minWidth:75,minHeight:75,resize:function(e,t){this.style.backgroundPosition="-"+t.position.left+"px -"+t.position.top+"px",jQuery(n).val(t.position.left),jQuery(i).val(t.position.top),jQuery(a).val(t.size.height),jQuery(o).val(t.size.width)},stop:function(e,t){this.style.backgroundPosition="-"+t.position.left+"px -"+t.position.top+"px"}}).draggable({cursor:"move",containment:"parent",drag:function(e,t){jQuery(n).val(t.position.left),jQuery(i).val(t.position.top),this.style.backgroundPosition="-"+t.position.left+"px -"+t.position.top+"px"}}).css({background:"transparent url("+e.src+") no-repeat scroll 0px 0px"}),jQuery(r).append(p),jQuery(r).append(t),jQuery(this).replaceWith(r)})},jQuery(document).ready(function(){jQuery("img.cropper").cropper()});